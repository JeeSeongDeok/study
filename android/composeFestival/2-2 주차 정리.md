## 4. Compose and ViewModels

TodoScreen.kt는 Stateless이여서, TodoScreen 자체로는 디자인을 수정할 수 없다. <br>

Stateless Composable을 수정하기 위해서는 Hoisting을 이용해 수정할 수 있다. <br>

```kotlin
class TodoViewModel : ViewModel() {
    // state: TodoItem
    private var _todoItems = MutableLiveData(listOf<TodoItem>())
    val todoItems: LiveData<List<TodoItem>> = _todoItems
    // event: 아이템 추가
    fun addItem(item: TodoItem) {
        _todoItems.value = _todoItems.value!! + listOf(item)
    }
    // event: 아이템 제거
    fun removeItem(item: TodoItem) {
        _todoItems.value = _todoItems.value!!.toMutableList().also {
            it.remove(item)
        }
    }
}
``` 
뷰모델을 이용해 TodoScreen에서 상태를 hositing을 할려고 한다.<br>
data flow은 다음 사진과 같이 이루어진다.<br>
<img src ="https://developer.android.com/codelabs/jetpack-compose-state/img/58baca1f648c1a64.png?authuser=4">

TodoActivity 
```kotlin
@Composable
private fun TodoActivityScreen(todoViewModel: TodoViewModel) {
   val items: List<TodoItem> by todoViewModel.todoItems.observeAsState(listOf())
   TodoScreen(
       items = items,
       onAddItem = { todoViewModel.addItem(it) },
       onRemoveItem = { todoViewModel.removeItem(it) }
   )
}
```
val items: List<TodoItem> by todoViewModel.todoItems.observeAsState(listOf())에서 viewmodel의 Livedata를 관찰함<br>
todoViewModel.todoItems는 뷰 모델의 todoItems를 지정하고 있으며, observeAsState는 LiveData를 관찰하고 State<T>로 반환해서 Compose가 값을 변경할 수 있도록 한다.<br>
listOf()는 null값을 피하기 위해서 초기값을 지정한 것이다. <br>
    
## 5. Memory in Compose
아이콘에 색깔을 추가하기 위해서 randomTint()를 씀<br>
해당 아이콘을 색깔을 추가하는 코드를 추가했는데 목록이 변경될 때 마다 randomTint()가 다시 호출됨<br>
<p align="center"><img src = "https://developer.android.com/codelabs/jetpack-compose-state/img/86dbbb4eefbc61c.gif?authuser=4"></p>
Recomposition(재구성)은 작성 트리를 업데이트하기 위해 새 입력으로 다시 구성을 호출하는 프로세스<br>
이 경우 새 목록으로 TodoScreen을 다시 호출하면 LazyColumn이 화면의 모든 자식을 재구성<br>
그러면 TodoRow가 다시 호출되어서 randomTint가 발생<br>
<p align="center"><img src = "https://developer.android.com/codelabs/jetpack-compose-state/img/6f5faa4342c63d88.png?authuser=4"></p>

### memory to composable function
Compose를 사용하면 컴포지션 트리에 값을 저장할 수 있다.<br>
remember는 Composable function memory를 제공함
```kotlin
val iconAlpha: Float = remember(todo.id) { randomTint() }
Icon(
   imageVector = todo.icon.imageVector,
   tint = LocalContentColor.current.copy(alpha = iconAlpha),
   contentDescription = stringResource(id = todo.icon.contentDescription)
)
```

## 6. State in Compose
Stateful composable은 변경가능한 상태를 소유하는 컴포저블<br>

